---
/**
 * Homepage - Kit-72 Hub
 *
 * Hub-style landing page focused on action, not reading.
 * Designed to get users to their first checklist in <60 seconds.
 *
 * Key changes from v1:
 * - Simplified hero with single CTA
 * - Scenario quick picker above the fold
 * - Returning user recognition
 * - Featured tool spotlight (not grid)
 * - Collapsed trust section
 */

import BaseLayout from '../../layouts/BaseLayout.astro';
import ScenarioQuickPicker from '../../components/hub/ScenarioQuickPicker.astro';
import Icon from '../../components/ui/Icon.astro';

const stats = [
  { value: '72h', label: 'autonomía' },
  { value: '3L', label: 'agua/día' },
  { value: '15', label: 'items clave' },
];
---

<BaseLayout
  title="Kit-72 — Prepárate para Emergencias"
  description="Guías paso a paso y herramientas para preparar tu kit de emergencia de 72 horas. Checklists personalizados para España."
  dateModified="2025-12-15"
  schemaType="WebPage"
  schemaData={{
    // FAQPage schema for AI SEO - makes content citable by LLMs
    mainEntity: [
      {
        '@type': 'Question',
        name: '¿Qué es un kit de emergencia de 72 horas?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Un kit de emergencia de 72 horas es un conjunto de suministros esenciales que te permite ser autosuficiente durante tres días en caso de una emergencia. Incluye agua (3 litros por persona/día), alimentos no perecederos, linterna, radio, botiquín de primeros auxilios y documentos importantes.',
        },
      },
      {
        '@type': 'Question',
        name: '¿Cuánta agua necesito almacenar para una emergencia?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Se recomienda almacenar un mínimo de 3 litros de agua por persona por día. Para una familia de 4 personas durante 72 horas, necesitarías aproximadamente 36 litros. En climas cálidos o para personas con necesidades especiales, considera aumentar esta cantidad.',
        },
      },
      {
        '@type': 'Question',
        name: '¿Cuáles son los 15 elementos esenciales de un kit de emergencia?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Los 15 elementos esenciales son: 1) Agua potable, 2) Alimentos no perecederos, 3) Linterna LED, 4) Radio de emergencia, 5) Pilas de repuesto, 6) Botiquín de primeros auxilios, 7) Medicamentos esenciales, 8) Documentos importantes, 9) Dinero en efectivo, 10) Cargador portátil/powerbank, 11) Silbato, 12) Manta térmica, 13) Herramienta multiusos, 14) Artículos de higiene, 15) Ropa de abrigo.',
        },
      },
      {
        '@type': 'Question',
        name: '¿Cómo prepararse para un apagón prolongado?',
        acceptedAnswer: {
          '@type': 'Answer',
          text: 'Para prepararte para un apagón: 1) Ten linternas LED y velas con cerillas, 2) Carga completamente tus dispositivos y powerbanks, 3) Llena la bañera con agua antes del corte, 4) Ten una radio a pilas para información, 5) Mantén el refrigerador cerrado, 6) Desconecta electrodomésticos sensibles, 7) Ten dinero en efectivo disponible.',
        },
      },
    ],
  }}
>
  <!-- Hero Section - Simplified -->
  <section class="hero">
    <div class="hero__container">
      <!-- Main content -->
      <div class="hero__content">
        <h1 class="hero__title">
          Prepárate para emergencias
          <span class="hero__accent">en 10 minutos</span>
        </h1>

        <p class="hero__subtitle">
          Elige tu situación y obtén un checklist personalizado.
          Sin alarmismo, solo lo esencial.
        </p>

        <!-- Stats inline -->
        <div class="hero__stats">
          {stats.map((stat) => (
            <div class="hero__stat">
              <span class="hero__stat-value">{stat.value}</span>
              <span class="hero__stat-label">{stat.label}</span>
            </div>
          ))}
        </div>
      </div>

      <!-- Scenario Quick Picker - Above the fold -->
      <div class="hero__scenarios">
        <p class="hero__scenarios-label">Elige tu escenario:</p>
        <ScenarioQuickPicker locale="es" />
      </div>

      <!-- Alternative CTA -->
      <div class="hero__alt-cta">
        <span class="hero__alt-text">o crea tu kit completo</span>
        <a href="/es/herramientas/configurador-kit/" class="hero__alt-link">
          Abrir Configurador
          <Icon name="ArrowRight" size={16} />
        </a>
      </div>
    </div>
  </section>

  <!-- Returning User Block (shown via JS if localStorage has progress) -->
  <section id="returning-user-block" class="returning-user hidden">
    <div class="returning-user__container">
      <div class="returning-user__content">
        <div class="returning-user__icon">
          <Icon name="RotateCw" size={20} />
        </div>
        <div class="returning-user__text">
          <span class="returning-user__label">Continúa donde lo dejaste</span>
          <span class="returning-user__progress" id="returning-progress">Cargando...</span>
        </div>
      </div>
      <a href="/es/herramientas/configurador-kit/" class="returning-user__button" id="returning-cta">
        Continuar
        <Icon name="ArrowRight" size={16} />
      </a>
    </div>
  </section>

  <!-- Featured Tool Spotlight -->
  <section class="tool-spotlight">
    <div class="tool-spotlight__container">
      <div class="tool-spotlight__content">
        <div class="tool-spotlight__badge">
          <Icon name="Zap" size={14} />
          Herramienta destacada
        </div>
        <h2 class="tool-spotlight__title">Configurador de Kit</h2>
        <p class="tool-spotlight__description">
          Responde 4 preguntas y obtén tu checklist personalizado
          según familia, mascotas y escenario. Imprimible y guardable.
        </p>
        <ul class="tool-spotlight__features">
          <li>
            <Icon name="Check" size={16} class="text-emerald-400" />
            Personalizado para tu situación
          </li>
          <li>
            <Icon name="Check" size={16} class="text-emerald-400" />
            Precios estimados incluidos
          </li>
          <li>
            <Icon name="Check" size={16} class="text-emerald-400" />
            Exporta a PDF o guarda online
          </li>
        </ul>
        <a href="/es/herramientas/configurador-kit/" class="tool-spotlight__cta">
          Crear mi kit ahora
          <Icon name="ArrowRight" size={18} />
        </a>
      </div>
      <div class="tool-spotlight__visual">
        <div class="tool-spotlight__preview">
          <div class="preview-header">
            <span class="preview-dot"></span>
            <span class="preview-dot"></span>
            <span class="preview-dot"></span>
          </div>
          <div class="preview-content">
            <div class="preview-progress">
              <div class="preview-progress-ring">
                <span>67%</span>
              </div>
              <div class="preview-progress-text">
                <span>10 de 15 items</span>
                <span class="preview-progress-label">completados</span>
              </div>
            </div>
            <div class="preview-items">
              <div class="preview-item preview-item--done">
                <Icon name="Check" size={14} />
                Linterna LED
              </div>
              <div class="preview-item preview-item--done">
                <Icon name="Check" size={14} />
                Powerbank 20000mAh
              </div>
              <div class="preview-item">
                <span class="preview-checkbox"></span>
                Radio de emergencia
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Other Tools (Compact) -->
  <section class="other-tools">
    <div class="other-tools__container">
      <h3 class="other-tools__title">Calculadoras</h3>
      <div class="other-tools__grid">
        <a href="/es/herramientas/calculadora-agua/" class="other-tool">
          <div class="other-tool__icon other-tool__icon--blue">
            <Icon name="Droplet" size={20} />
          </div>
          <div class="other-tool__content">
            <span class="other-tool__title">Agua</span>
            <span class="other-tool__desc">Litros necesarios</span>
          </div>
          <Icon name="ChevronRight" size={18} class="other-tool__arrow" />
        </a>
        <a href="/es/herramientas/calculadora-energia/" class="other-tool">
          <div class="other-tool__icon other-tool__icon--amber">
            <Icon name="Battery" size={20} />
          </div>
          <div class="other-tool__content">
            <span class="other-tool__title">Energía</span>
            <span class="other-tool__desc">Capacidad de batería</span>
          </div>
          <Icon name="ChevronRight" size={18} class="other-tool__arrow" />
        </a>
      </div>
    </div>
  </section>

  <!-- Trust Section (Collapsed by default) -->
  <section class="trust-section">
    <div class="trust-section__container">
      <details class="trust-details">
        <summary class="trust-summary">
          <div class="trust-summary__content">
            <Icon name="Shield" size={20} class="trust-summary__icon" />
            <span class="trust-summary__text">
              Basado en Protección Civil y Cruz Roja
            </span>
          </div>
          <Icon name="ChevronDown" size={18} class="trust-summary__chevron" />
        </summary>
        <div class="trust-content">
          <p>
            Kit-72 ofrece información práctica basada en recomendaciones oficiales
            de organismos de emergencias. Nuestro enfoque es realista: qué necesitas,
            cuánto, y por qué. Sin exageraciones ni preparacionismo extremo.
          </p>
          <div class="trust-features">
            <div class="trust-feature">
              <Icon name="CheckCircle" size={18} class="text-emerald-400" />
              <span>Fuentes verificadas</span>
            </div>
            <div class="trust-feature">
              <Icon name="SlidersHorizontal" size={18} class="text-amber-400" />
              <span>Personalizable</span>
            </div>
            <div class="trust-feature">
              <Icon name="Printer" size={18} class="text-blue-400" />
              <span>Imprimible</span>
            </div>
          </div>
        </div>
      </details>
    </div>
  </section>
</BaseLayout>

<style>
  /* Hero Section */
  .hero {
    padding: 2rem 0 1.5rem;
    background: linear-gradient(to bottom, var(--color-bg-secondary), var(--color-bg-primary));
  }

  .hero__container {
    max-width: 72rem;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .hero__content {
    text-align: center;
    margin-bottom: 2rem;
  }

  .hero__title {
    font-size: 1.75rem;
    font-weight: 700;
    line-height: 1.2;
    margin-bottom: 0.75rem;
    color: var(--color-text-primary);
  }

  .hero__accent {
    display: block;
    color: var(--color-accent-primary);
  }

  .hero__subtitle {
    font-size: 1rem;
    color: var(--color-text-secondary);
    margin-bottom: 1.5rem;
    line-height: 1.5;
  }

  .hero__stats {
    display: flex;
    justify-content: center;
    gap: 2rem;
  }

  .hero__stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .hero__stat-value {
    font-family: var(--font-mono);
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-accent-primary);
  }

  .hero__stat-label {
    font-size: 0.7rem;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .hero__scenarios {
    margin-bottom: 1.5rem;
  }

  .hero__scenarios-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-secondary);
    margin-bottom: 0.75rem;
    text-align: center;
  }

  .hero__alt-cta {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    padding-top: 1rem;
    border-top: 1px solid var(--color-border);
  }

  .hero__alt-text {
    font-size: 0.875rem;
    color: var(--color-text-muted);
  }

  .hero__alt-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-accent-primary);
    text-decoration: none;
  }

  .hero__alt-link:hover {
    text-decoration: underline;
  }

  /* Returning User Block */
  .returning-user {
    padding: 0 1rem 1rem;
  }

  .returning-user.hidden {
    display: none;
  }

  .returning-user__container {
    max-width: 72rem;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding: 1rem;
    background: linear-gradient(135deg, var(--color-accent-primary)/10, var(--color-accent-primary)/5);
    border: 1px solid var(--color-accent-primary)/30;
    border-radius: 1rem;
  }

  .returning-user__content {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .returning-user__icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-accent-primary)/20;
    border-radius: 10px;
    color: var(--color-accent-primary);
  }

  .returning-user__text {
    display: flex;
    flex-direction: column;
  }

  .returning-user__label {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-primary);
  }

  .returning-user__progress {
    font-size: 0.75rem;
    color: var(--color-text-muted);
  }

  .returning-user__button {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--color-accent-primary);
    color: var(--color-bg-primary);
    font-size: 0.875rem;
    font-weight: 600;
    border-radius: 0.5rem;
    text-decoration: none;
    white-space: nowrap;
  }

  /* Tool Spotlight */
  .tool-spotlight {
    padding: 3rem 1rem;
    background: var(--color-bg-secondary);
    border-top: 1px solid var(--color-border);
  }

  .tool-spotlight__container {
    max-width: 72rem;
    margin: 0 auto;
    display: grid;
    gap: 2rem;
  }

  .tool-spotlight__badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.25rem 0.75rem;
    background: var(--color-accent-primary)/10;
    color: var(--color-accent-primary);
    font-size: 0.75rem;
    font-weight: 600;
    border-radius: 1rem;
    margin-bottom: 1rem;
  }

  .tool-spotlight__title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    color: var(--color-text-primary);
  }

  .tool-spotlight__description {
    font-size: 1rem;
    color: var(--color-text-secondary);
    margin-bottom: 1.5rem;
    line-height: 1.6;
  }

  .tool-spotlight__features {
    list-style: none;
    padding: 0;
    margin: 0 0 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .tool-spotlight__features li {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .tool-spotlight__cta {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.875rem 1.5rem;
    background: var(--color-accent-primary);
    color: var(--color-bg-primary);
    font-size: 1rem;
    font-weight: 600;
    border-radius: 0.75rem;
    text-decoration: none;
    transition: background 0.2s;
  }

  .tool-spotlight__cta:hover {
    background: var(--color-accent-hover);
  }

  /* Tool Preview Visual */
  .tool-spotlight__visual {
    display: none;
  }

  .tool-spotlight__preview {
    background: var(--color-bg-primary);
    border: 1px solid var(--color-border);
    border-radius: 1rem;
    overflow: hidden;
  }

  .preview-header {
    display: flex;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--color-bg-tertiary);
    border-bottom: 1px solid var(--color-border);
  }

  .preview-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--color-border);
  }

  .preview-content {
    padding: 1.5rem;
  }

  .preview-progress {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .preview-progress-ring {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: conic-gradient(var(--color-accent-primary) 67%, var(--color-bg-tertiary) 0);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .preview-progress-ring::before {
    content: '';
    position: absolute;
    width: 48px;
    height: 48px;
    background: var(--color-bg-primary);
    border-radius: 50%;
  }

  .preview-progress-ring span {
    position: relative;
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--color-accent-primary);
  }

  .preview-progress-text {
    display: flex;
    flex-direction: column;
    font-size: 0.875rem;
    color: var(--color-text-primary);
  }

  .preview-progress-label {
    font-size: 0.75rem;
    color: var(--color-text-muted);
  }

  .preview-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .preview-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: var(--color-bg-secondary);
    border-radius: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .preview-item--done {
    color: var(--color-text-muted);
    text-decoration: line-through;
  }

  .preview-item--done svg {
    color: var(--color-status-success);
  }

  .preview-checkbox {
    width: 16px;
    height: 16px;
    border: 2px solid var(--color-border);
    border-radius: 4px;
  }

  /* Other Tools */
  .other-tools {
    padding: 2rem 1rem;
    border-top: 1px solid var(--color-border);
  }

  .other-tools__container {
    max-width: 72rem;
    margin: 0 auto;
  }

  .other-tools__title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1rem;
  }

  .other-tools__grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
  }

  .other-tool {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 0.75rem;
    text-decoration: none;
    transition: border-color 0.2s;
  }

  .other-tool:hover {
    border-color: var(--color-accent-primary)/50;
  }

  .other-tool__icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.5rem;
    flex-shrink: 0;
  }

  .other-tool__icon--blue {
    background: #3b82f6/10;
    color: #3b82f6;
  }

  .other-tool__icon--amber {
    background: #f59e0b/10;
    color: #f59e0b;
  }

  .other-tool__content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
  }

  .other-tool__title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-primary);
  }

  .other-tool__desc {
    font-size: 0.75rem;
    color: var(--color-text-muted);
  }

  .other-tool__arrow {
    color: var(--color-text-muted);
    flex-shrink: 0;
  }

  /* Trust Section */
  .trust-section {
    padding: 1.5rem 1rem 2rem;
    border-top: 1px solid var(--color-border);
  }

  .trust-section__container {
    max-width: 72rem;
    margin: 0 auto;
  }

  .trust-details {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 0.75rem;
    overflow: hidden;
  }

  .trust-summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    cursor: pointer;
    list-style: none;
  }

  .trust-summary::-webkit-details-marker {
    display: none;
  }

  .trust-summary__content {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .trust-summary__icon {
    color: var(--color-accent-primary);
  }

  .trust-summary__text {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-secondary);
  }

  .trust-summary__chevron {
    color: var(--color-text-muted);
    transition: transform 0.2s;
  }

  .trust-details[open] .trust-summary__chevron {
    transform: rotate(180deg);
  }

  .trust-content {
    padding: 0 1rem 1rem;
  }

  .trust-content p {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .trust-features {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .trust-feature {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8125rem;
    color: var(--color-text-secondary);
  }

  /* Desktop styles */
  @media (min-width: 768px) {
    .hero {
      padding: 4rem 0 2rem;
    }

    .hero__container {
      padding: 0 1.5rem;
    }

    .hero__title {
      font-size: 2.5rem;
    }

    .hero__accent {
      display: inline;
    }

    .hero__subtitle {
      font-size: 1.125rem;
      max-width: 32rem;
      margin-left: auto;
      margin-right: auto;
    }

    .tool-spotlight__container {
      grid-template-columns: 1fr 1fr;
      align-items: center;
    }

    .tool-spotlight__visual {
      display: block;
    }

    .other-tools__grid {
      grid-template-columns: repeat(2, minmax(200px, 300px));
      justify-content: center;
    }
  }
</style>

<script>
  // Check for returning user progress
  document.addEventListener('DOMContentLoaded', () => {
    const storedProgress = localStorage.getItem('kit72_progress');
    if (storedProgress) {
      try {
        const progress = JSON.parse(storedProgress);
        const block = document.getElementById('returning-user-block');
        const progressText = document.getElementById('returning-progress');

        if (block && progress.checklist?.items) {
          const items = Object.values(progress.checklist.items);
          const completed = items.filter(Boolean).length;
          const total = items.length;

          if (total > 0 && completed > 0) {
            block.classList.remove('hidden');
            if (progressText) {
              progressText.textContent = `${completed} de ${total} items completados`;
            }
          }
        }
      } catch {
        // Invalid data, ignore
      }
    }
  });
</script>
